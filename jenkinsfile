 node{
 stage('Deploy'){
	 sh """	
	 	
		
		
		export length=\$(kubectl get deployments | grep mywebapp | wc -l)
		 if [ \$length -gt 0 ]
		 then
		 kubectl rollout restart deployment/mywebapp
		 kubectl rollout status deployment/mywebapp
		 else
		 kubectl create deployment mywebapp --image shrutshah/mywebapp:v1
		 kubectl scale deployment mywebapp --replicas=3
		 sudo kubectl expose deployment mywebapp --port 8080 --type LoadBalancer
		 fi
		
		
        """
 }  
}      
